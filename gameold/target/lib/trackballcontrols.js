define(["three"],function(t){t.TrackballControls=function(e,o){var n=this,i={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=e,this.domElement=void 0!==o?o:document,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=[65,83,68],this.target=new t.Vector3;var c=1e-6,s=new t.Vector3,r=i.NONE,a=i.NONE,p=new t.Vector3,h=new t.Vector2,l=new t.Vector2,d=new t.Vector3,u=0,m=new t.Vector2,y=new t.Vector2,g=0,w=0,b=new t.Vector2,f=new t.Vector2;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone();var V={type:"change"};this.handleResize=function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=window.innerWidth,this.screen.height=window.innerHeight;else{var t=this.domElement.getBoundingClientRect(),e=this.domElement.ownerDocument.documentElement;this.screen.left=t.left+window.pageXOffset-e.clientLeft,this.screen.top=t.top+window.pageYOffset-e.clientTop,this.screen.width=t.width,this.screen.height=t.height}},this.handleEvent=function(t){"function"==typeof this[t.type]&&this[t.type](t)};var j=(function(){var e=new t.Vector2;return function(t,o){return e.set((t-n.screen.left)/n.screen.width,(o-n.screen.top)/n.screen.height),e}}(),function(){var e=new t.Vector2;return function(t,o){return e.set((t-.5*n.screen.width-n.screen.left)/(.5*n.screen.width),(n.screen.height+2*(n.screen.top-o))/n.screen.width),e}}());this.rotateCamera=function(){var e,o=new t.Vector3,i=new t.Quaternion,c=new t.Vector3,s=new t.Vector3,r=new t.Vector3,a=new t.Vector3;return function(){a.set(l.x-h.x,l.y-h.y,0),e=a.length(),e?(p.copy(n.object.position).sub(n.target),c.copy(p).normalize(),s.copy(n.object.up).normalize(),r.crossVectors(s,c).normalize(),s.setLength(l.y-h.y),r.setLength(l.x-h.x),a.copy(s.add(r)),o.crossVectors(a,p).normalize(),e*=n.rotateSpeed,i.setFromAxisAngle(o,e),p.applyQuaternion(i),n.object.up.applyQuaternion(i),d.copy(o),u=e):!n.staticMoving&&u&&(u*=Math.sqrt(1-n.dynamicDampingFactor),p.copy(n.object.position).sub(n.target),i.setFromAxisAngle(d,u),p.applyQuaternion(i),n.object.up.applyQuaternion(i)),h.copy(l)}}(),this.zoomCamera=function(){var t;r===i.TOUCH_ZOOM_PAN?(t=g/w,g=w,p.multiplyScalar(t)):(t=1+(y.y-m.y)*n.zoomSpeed,1!==t&&t>0&&p.multiplyScalar(t),n.staticMoving?m.copy(y):m.y+=(y.y-m.y)*this.dynamicDampingFactor)},this.panCamera=function(){var e=new t.Vector2,o=new t.Vector3,i=new t.Vector3;return function(){e.copy(f).sub(b),e.lengthSq()&&(e.multiplyScalar(p.length()*n.panSpeed),i.copy(p).cross(n.object.up).setLength(e.x),i.add(o.copy(n.object.up).setLength(e.y)),n.object.position.add(i),n.target.add(i),n.staticMoving?b.copy(f):b.add(e.subVectors(f,b).multiplyScalar(n.dynamicDampingFactor)))}}(),this.checkDistances=function(){n.noZoom&&n.noPan||(p.lengthSq()>n.maxDistance*n.maxDistance&&(n.object.position.addVectors(n.target,p.setLength(n.maxDistance)),m.copy(y)),p.lengthSq()<n.minDistance*n.minDistance&&(n.object.position.addVectors(n.target,p.setLength(n.minDistance)),m.copy(y)))},this.update=function(){p.subVectors(n.object.position,n.target),n.noRotate||n.rotateCamera(),n.noZoom||n.zoomCamera(),n.noPan||n.panCamera(),n.object.position.addVectors(n.target,p),n.checkDistances(),n.object.lookAt(n.target),s.distanceToSquared(n.object.position)>c&&(n.dispatchEvent(V),s.copy(n.object.position))},this.reset=function(){r=i.NONE,a=i.NONE,n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.up.copy(n.up0),p.subVectors(n.object.position,n.target),n.object.lookAt(n.target),n.dispatchEvent(V),s.copy(n.object.position)},this.threemm=function(t){n.enabled!==!1&&(h.copy(l),l.copy(j(t.pageX,t.pageY)))},this.handleResize(),this.update()},t.TrackballControls.prototype=Object.create(t.EventDispatcher.prototype),t.TrackballControls.prototype.constructor=t.TrackballControls});